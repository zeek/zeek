# @TEST-DOC: Test zeek-cut with time conversion options (-D/-U).
#

# Test -D option.
# @TEST-EXEC: cat $ZEEK_CUT_LOGS/conn.log | TZ=PST+8 zeek-cut -D "%H %M %y %m %d" > local-fmt
# @TEST-EXEC: TEST_DIFF_CANONIFIER= btest-diff local-fmt

# Test -U option.
# @TEST-EXEC: cat $ZEEK_CUT_LOGS/conn.log | TZ=PST+8 zeek-cut -U "%H %M %y %m %d" > utc-fmt
# @TEST-EXEC: TEST_DIFF_CANONIFIER= btest-diff utc-fmt

# Output local time (-D overrides -u).
# @TEST-EXEC: cat $ZEEK_CUT_LOGS/conn.log | TZ=PST+8 zeek-cut -u -D "%H %M %y %m %d" > utc-local-fmt
# @TEST-EXEC: TEST_DIFF_CANONIFIER= btest-diff utc-local-fmt

# Output UTC time, but with format string from -D.
# @TEST-EXEC: cat $ZEEK_CUT_LOGS/conn.log | TZ=PST+8 zeek-cut -D "%H %M %y %m %d" -u > local-fmt-utc
# @TEST-EXEC: TEST_DIFF_CANONIFIER= btest-diff local-fmt-utc

# Output UTC time (-U overrides -d).
# @TEST-EXEC: cat $ZEEK_CUT_LOGS/conn.log | TZ=PST+8 zeek-cut -d -U "%H %M %y %m %d" > local-utc-fmt
# @TEST-EXEC: TEST_DIFF_CANONIFIER= btest-diff local-utc-fmt

# Output local time, but with format string from -U.
# @TEST-EXEC: cat $ZEEK_CUT_LOGS/conn.log | TZ=PST+8 zeek-cut -U "%H %M %y %m %d" -d > utc-fmt-local
# @TEST-EXEC: TEST_DIFF_CANONIFIER= btest-diff utc-fmt-local
